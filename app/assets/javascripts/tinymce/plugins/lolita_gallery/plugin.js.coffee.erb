tinymce.PluginManager.add "lolita_gallery", (editor) ->

  # Add a button that opens a window
  editor.ui.registry.addButton "lolita_gallery",
    tooltip: "<%= I18n.t("lolita.upload.gallery.tinymce.button_text") %>"
    icon: "gallery"
    onAction: -> window.LolitaFileUploadGallery.get().toggle()

  # Adds a menu item to the tools menu
  editor.ui.registry.addMenuItem "lolita_gallery",
    text: "<%= I18n.t("lolita.upload.gallery.tinymce.button_text") %>"
    icon: "gallery"
    onAction: -> window.LolitaFileUploadGallery.get().toggle()

  return {
    name: 'lolita_gallery',
    url: 'https://github.com/ithouse/lolita-file-upload'
  }
